---
- name: install and run heat eol tests from upstream
  hosts: undercloud
  roles:
    - testconfig
  tasks:
    - name: install git repo with tags
      git:
        repo: 'git://git.openstack.org/openstack/heat'
        dest: /home/stack/heat
        version: tags/mitaka-eol
        clone: no
        update: no


    - name: run tests with testr
      shell: |
        source "{{ overcloudrc }}"
        testr init
        testr run heat_integrationtests.functional
      args:
        chdir: /home/stack/heat


